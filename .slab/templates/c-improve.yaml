name: c-improve
command: /c-improve
description: Refactor C code to safer, more robust C following MISRA/CERT standards
prompt: |
  Refactor the attached C code into safer, more robust C.

  Requirements:
  1. Use fixed-width types (stdint.h) - uint32_t, int64_t, size_t, etc.
  2. Add explicit error handling with enum return codes
  3. Remove all static/global state - pass context explicitly
  4. Add const correctness for all read-only parameters
  5. Add restrict keywords for non-aliasing pointers
  6. Add NULL pointer checks at function entry
  7. Add bounds checking for array accesses
  8. Use bool from stdbool.h instead of int flags
  9. Add comprehensive function documentation
  10. Keep cyclomatic complexity < 10
  11. Maximum function length: 50 lines
  12. MAINTAIN PERFORMANCE - no heap allocations in hot paths

  Target standards: MISRA C:2012, CERT C

  IMPORTANT: Output the COMPLETE refactored file inside a fenced code block
  annotated with the target file path using this exact format:

  ```c:{{content}}
  // complete refactored code here
  ```

  The path after the colon is critical â€” it tells the system which file to
  create or overwrite. You MUST include every line of the file, not just
  changed sections. Do NOT omit any code or use "// ... rest unchanged"
  placeholders.

  After the code block, provide a brief explanation of the safety improvements made.

  {{files}}
